<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#111111" />
  <meta name="description" content="SuperLuis.app - Rutinas, descanso, control por voz y seguimiento de tu progreso." />

  <title>SuperLuis.app</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <!-- Estilos principales (modo oscuro) -->
  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background-color: #111;
      color: #f5f5f5;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #1a1a1a;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      border-bottom: 1px solid #333;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background: #1a1a1a;
      padding: 0.5rem;
      border-bottom: 1px solid #333;
    }
    nav button {
      background: none;
      border: none;
      color: #f5f5f5;
      font-size: 1rem;
      padding: 0.5rem;
      cursor: pointer;
    }
    nav button:hover {
      color: #007bff;
    }
    main {
      flex: 1;
      padding: 1.5rem;
    }
    footer {
      background: #1a1a1a;
      text-align: center;
      padding: 1rem;
      border-top: 1px solid #333;
      font-size: 0.9rem;
    }
    .card {
      background: #1e1e1e;
      padding: 1rem;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    }
    .btn {
      display: inline-block;
      background: #007bff;
      color: white;
      padding: 0.75rem 1.25rem;
      border-radius: 0.5rem;
      text-decoration: none;
      border: none;
      cursor: pointer;
      margin: 0.25rem;
      transition: background 0.3s;
    }
    .btn:hover { background: #0056b3; }
    .btn-red { background: #dc3545; }
    .btn-green { background: #28a745; }
    .btn-yellow { background: #ffc107; color:#111; }
    .btn-gray { background: #6c757d; }
    .controls { margin-top: 1rem; }
    #timer {
      font-size: 2rem;
      text-align: center;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <header>ğŸ’ª SuperLuis.app</header>

  <nav>
    <button onclick="showTab('rutinas')">Rutinas</button>
    <button onclick="showTab('descanso')">Descanso</button>
    <button onclick="showTab('voz')">Voces</button>
    <button onclick="showTab('ajustes')">Ajustes</button>
  </nav>

  <main id="content">
    <!-- SecciÃ³n Rutinas -->
    <section id="rutinas" class="tab card">
      <h2>Rutina de Hoy</h2>
      <ul id="routine-list">
        <li>ğŸ‹ï¸â€â™‚ï¸ Sentadillas - 3x12</li>
        <li>ğŸ‹ï¸â€â™‚ï¸ Press banca - 3x10</li>
        <li>ğŸ‹ï¸â€â™‚ï¸ Remo con barra - 3x12</li>
        <li>ğŸ‹ï¸â€â™‚ï¸ Planchas - 3x45s</li>
      </ul>
      <div class="controls">
        <button class="btn btn-green">â–¶ï¸ Reanudar</button>
        <button class="btn btn-yellow">â¸ï¸ Pausa</button>
        <button class="btn btn-red">â­ï¸ Saltar</button>
      </div>
    </section>

    <!-- SecciÃ³n Descanso -->
    <section id="descanso" class="tab card" style="display:none">
      <h2>Tiempo de Descanso</h2>
      <p id="timer">00:30</p>
      <div class="controls">
        <button class="btn btn-green" onclick="startTimer()">â–¶ï¸ Reanudar</button>
        <button class="btn btn-yellow" onclick="pauseTimer()">â¸ï¸ Pausar</button>
        <button class="btn btn-red" onclick="skipTimer()">â­ï¸ Saltar</button>
      </div>
    </section>

    <!-- SecciÃ³n Voces -->
    <section id="voz" class="tab card" style="display:none">
      <h2>Control por Voz</h2>
      <p>Activa las voces para guiar tus entrenamientos.</p>
      <div class="controls">
        <button class="btn btn-green" onclick="speak('Â¡Vamos! Tu entrenamiento comienza ahora.')">ğŸ¤ Activar</button>
        <button class="btn btn-gray" onclick="stopSpeaking()">ğŸ”‡ Desactivar</button>
        <button class="btn btn-yellow">âš™ï¸ Configurar</button>
      </div>
    </section>

    <!-- SecciÃ³n Ajustes -->
    <section id="ajustes" class="tab card" style="display:none">
      <h2>Ajustes</h2>
      <button class="btn btn-gray" onclick="editRoutine()">âœï¸ Editar Rutinas</button>
      <button class="btn btn-gray" onclick="importRoutine()">ğŸ“¥ Importar</button>
      <button class="btn btn-gray" onclick="exportRoutine()">ğŸ“¤ Exportar</button>
      <input type="file" id="fileInput" accept="application/json" style="display:none" />
    </section>
  </main>

  <footer>Â© 2025 SuperLuis</footer>

  <!-- Scripts -->
  <script>
    // -------- Tabs --------
    function showTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.style.display = 'none');
      document.getElementById(tabId).style.display = 'block';
    }

    // -------- Temporizador --------
    let timerInterval;
    let remaining = 30; // segundos
    let isRunning = false;

    function updateTimerDisplay() {
      const minutes = String(Math.floor(remaining / 60)).padStart(2, '0');
      const seconds = String(remaining % 60).padStart(2, '0');
      document.getElementById("timer").textContent = `${minutes}:${seconds}`;
    }

    function startTimer() {
      if (isRunning) return;
      isRunning = true;
      timerInterval = setInterval(() => {
        if (remaining > 0) {
          remaining--;
          updateTimerDisplay();
        } else {
          clearInterval(timerInterval);
          isRunning = false;
          speak("Â¡Descanso terminado! A seguir entrenando.");
        }
      }, 1000);
    }
    function pauseTimer() {
      clearInterval(timerInterval);
      isRunning = false;
    }
    function skipTimer() {
      clearInterval(timerInterval);
      remaining = 0;
      updateTimerDisplay();
      isRunning = false;
      speak("Descanso saltado, continuamos.");
    }
    updateTimerDisplay();

    // -------- Voz --------
    let utterance;
    function speak(text) {
      stopSpeaking();
      utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = "es-ES";
      speechSynthesis.speak(utterance);
    }
    function stopSpeaking() {
      if (speechSynthesis.speaking) {
        speechSynthesis.cancel();
      }
    }

    // -------- Rutinas (import/export) --------
    let routine = [
      "ğŸ‹ï¸â€â™‚ï¸ Sentadillas - 3x12",
      "ğŸ‹ï¸â€â™‚ï¸ Press banca - 3x10",
      "ğŸ‹ï¸â€â™‚ï¸ Remo con barra - 3x12",
      "ğŸ‹ï¸â€â™‚ï¸ Planchas - 3x45s"
    ];

    function renderRoutine() {
      const ul = document.getElementById("routine-list");
      ul.innerHTML = "";
      routine.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        ul.appendChild(li);
      });
    }

    function editRoutine() {
      const nuevo = prompt("Escribe la rutina separada por comas:", routine.join(", "));
      if (nuevo) {
        routine = nuevo.split(",").map(r => r.trim());
        renderRoutine();
      }
    }

    function exportRoutine() {
      const blob = new Blob([JSON.stringify(routine, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "rutina.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function importRoutine() {
      document.getElementById("fileInput").click();
    }

    document.getElementById("fileInput").addEventListener("change", e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        try {
          routine = JSON.parse(reader.result);
          renderRoutine();
          alert("Rutina importada con Ã©xito âœ…");
        } catch (err) {
          alert("Error al importar rutina âŒ");
        }
      };
      reader.readAsText(file);
    });

    renderRoutine();

    // -------- Service Worker (PWA) --------
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("/service-worker.js")
          .then(reg => console.log("Service Worker registrado:", reg))
          .catch(err => console.error("Error al registrar SW:", err));
      });
    }
  </script>
</body>
</html>